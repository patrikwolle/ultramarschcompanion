<div class="screen" role="main" aria-label="Übersicht und Freunde">
  <div class="topbar" role="region" aria-label="Hinzufügen und Sortierung">
    <section class="add" role="region" aria-label="Freund hinzufügen">
      <form
        class="add__form"
        aria-label="Freund hinzufügen"
        (submit)="addFriend(friendBox.value); friendBox.value = ''"
      >
        <p-floatlabel variant="on">
          <input
            #friendBox
            class="add__input"
            type="text"
            pInputText
            autocomplete="off"
            aria-label="Freund"
            (keydown.enter)="addFriend(friendBox.value); friendBox.value = ''"
            fluid
          />
          <label for="on_label">Vorname N.</label>
        </p-floatlabel>
        <button class="add__btn" type="submit">Hinzufügen</button>

        <nav class="toolbar" aria-label="Sortierung" role="navigation">
          <div class="toolbar__group">
            <div class="toolbar__label">Sortierung:</div>
            <button
              type="button"
              class="btn"
              [class.is-active]="sortKey === 'name'"
              (click)="setSortKey('name')"
            >
              Name {{ sortKey === "name" ? (asc ? "▲" : "▼") : "" }}
            </button>

            <button
              type="button"
              class="btn"
              [class.is-active]="sortKey === 'progress'"
              (click)="setSortKey('progress')"
            >
              Fortschritt {{ sortKey === "progress" ? (asc ? "▲" : "▼") : "" }}
            </button>

            <button
              type="button"
              class="btn"
              [class.is-active]="sortKey === 'done'"
              (click)="setSortKey('done')"
            >
              km {{ sortKey === "done" ? (asc ? "▲" : "▼") : "" }}
            </button>
          </div>
        </nav>
      </form>
    </section>

    <section role="region" aria-label="Freundesliste">
      <ul
        class="friends__list"
        *ngIf="renderFriends?.length; else emptyState"
        role="list"
        aria-live="polite"
        aria-label="Freunde"
      >
        <li
          class="friends__item"
          *ngFor="let r of renderFriends; trackBy: trackByName"
          [class.is-pinned]="isPinned(r)"
          role="listitem"
        >
          <button
            type="button"
            class="pin-btn"
            (click)="togglePin(r)"
            [attr.aria-pressed]="isPinned(r)"
            [class.is-active]="isPinned(r)"
            [title]="isPinned(r) ? 'Anpinnen aufheben' : 'Anpinnen'"
          >
            <i [ngClass]="isPinned(r) ? 'pi pi-star-fill' : 'pi pi-star'"></i>
          </button>

          <button
            type="button"
            class="remove-btn"
            (click)="confirmRemove(r)"
            [title]="'Entfernen'"
          >
            <i class="pi pi-trash"></i>
          </button>
          <um-friend [friend]="r" [pinned]="isPinned(r)"></um-friend>
        </li>
      </ul>

      <ng-template #emptyState>
        <div class="friends__empty" role="status" aria-live="polite">
          Noch keine Einträge. Füge oben jemanden hinzu.
        </div>
      </ng-template>
    </section>
  </div>
  <div class="spacer"></div>
</div>

<p-speeddial
  [model]="fabItems"
  direction="up"
  showIcon="pi pi-plus"
  hideIcon="pi pi-times"
  class="fab-wrap"
/>
