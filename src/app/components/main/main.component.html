<div class="screen">
  <div class="topbar">
    <section class="add">
      <form
        class="add__form"
        aria-label="Freund hinzufügen"
        (submit)="addFriend(friendBox.value); friendBox.value = ''"
      >
        <input
          #friendBox
          class="add__input"
          type="text"
          placeholder="Vorname N."
          autocomplete="off"
          aria-label="Freund"
          (keydown.enter)="addFriend(friendBox.value); friendBox.value = ''"
        />
        <button class="add__btn" type="submit">Hinzufügen</button>
        <nav class="toolbar" aria-label="Sortierung">
          <div class="toolbar__group">
            <div class="toolbar__label">Sortierung:</div>
            <button
              type="button"
              class="btn"
              [class.is-active]="sortKey === 'name'"
              (click)="setSortKey('name')"
            >
              Name {{ sortKey === "name" ? (asc ? "▲" : "▼") : "" }}
            </button>

            <button
              type="button"
              class="btn"
              [class.is-active]="sortKey === 'progress'"
              (click)="setSortKey('progress')"
            >
              Fortschritt {{ sortKey === "progress" ? (asc ? "▲" : "▼") : "" }}
            </button>

            <button
              type="button"
              class="btn"
              [class.is-active]="sortKey === 'done'"
              (click)="setSortKey('done')"
            >
              km {{ sortKey === "done" ? (asc ? "▲" : "▼") : "" }}
            </button>
          </div>
        </nav>
      </form>
    </section>

    <section>
      <ul class="friends__list" *ngIf="renderFriends?.length; else emptyState">
        <li
          class="friends__item"
          *ngFor="let r of renderFriends; trackBy: trackByName"
          [class.is-pinned]="isPinned(r)"
        >
          <button
            type="button"
            class="pin-btn"
            (click)="togglePin(r)"
            [attr.aria-pressed]="isPinned(r)"
            [class.is-active]="isPinned(r)"
            [title]="isPinned(r) ? 'Anpinnen aufheben' : 'Anpinnen'"
          >
            <i [ngClass]="isPinned(r) ? 'pi pi-star-fill' : 'pi pi-star'"></i>
          </button>

          <button
            type="button"
            class="remove-btn"
            (click)="confirmRemove(r)"
            [title]="'Entfernen'"
          >
            <i class="pi pi-trash"></i>
          </button>
          <um-friend [friend]="r" [pinned]="isPinned(r)"></um-friend>
        </li>
      </ul>

      <ng-template #emptyState>
        <div class="friends__empty">
          Noch keine Einträge. Füge oben jemanden hinzu.
        </div>
      </ng-template>
    </section>
  </div>
</div>

<button
  type="button"
  class="fab"
  aria-label="Aktivität hinzufügen"
  (click)="openUploadDialog()"
>
  <i class="pi pi-plus"></i>
</button>
